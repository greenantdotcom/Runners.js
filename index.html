<html>
<head>
	<script type="text/javascript" src="WorkerConsole.js"></script>
	<script type="text/javascript" src="w.js"></script>
</head>
<body>
	<script>
		var pool = Workers.newFixedWorkerPool(2);

		// TODO: return promises
		// TODO: allow callback when promise completes
		function busy() {
			var a = 0;
			while(true) {
				a+=1;
			}
		}

		// pool.execute(busy);
		// pool.execute(busy);

		pool.submit(function() {
			console.log('Hello');
		});
		pool.submit(function() {
			console.log('hoodby');
		});
		var promise = pool.submit(function() {
			console.log('hoodbye');
			throw 'shit shit';
		});

		promise.then(function() {
			console.log('Nice!');
		}, function() {
			console.log('Not nice :/');
		});

		console.log(promise);
	</script
</body>
</html>